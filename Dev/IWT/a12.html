<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IWT 11 (Cookie setter)</title>
</head>

<body>
    
    <button onclick="auth()">set Auth cookie</button>
    <button onclick="authClear()">remove auth cookie</button><br><br>
    <button onclick="clearAll()">remove all cookies</button><br><br>
    <input type="text" class="i1" placeholder="cookie">
    <input type="text" class="i2" placeholder="value">
    <input type="text" class="i3" placeholder="path">
    <input type="text" class="i4" placeholder="life in days">
    <button onclick="setCookie()">Set Cookie</button>
    <div class="status">auth status: </div>
    Cookie: <div class="cookie"></div>

    <script>
        
        var setCookie = (name, value, days, path ) => {
            var input1 = document.querySelector('.i1');
            var input2 = document.querySelector('.i2');
            var input3 = document.querySelector('.i1');
            var input4 = document.querySelector('.i2');

            let Name = name ? name : input1.value;
            let Value = value ? value : input2.value;
            let Days = days ? days : (input3.value ? input3.value : 1);
            let Path = path ? path : input4.value;

            console.log('name '+Name, 'value '+Value, 'days '+Days, 'path '+Path);

            let cookie = `${Name}=${encodeURIComponent(Value)}`;

            // Add expiry date
            if (days) {
                const expiry = new Date();
                expiry.setDate(expiry.getDate() + days);
                cookie += `; expires=${expiry.toUTCString()}`;
            }

            // Add Path
            if (path) cookie += `; path=${path}`;

            // Set an HTTP cookie
            document.cookie = cookie;
            updateStatus()
        };

        var clearAll = function(){
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                let c = cookies[i].trim().split('=');
                let name = c[0];
                let value = '';
                setCookie(name, value, -1)
            }
            console.log(document.cookie)
        }


        var auth = function() {
            let name = 'auth';
            let value = `AuthValue${Math.random()}`;
            setCookie(name, value, 3)
            updateStatus()
        }
        function authClear() {
            let name = 'auth';
            let value = ``;
            setCookie(name, value, -1)
            updateStatus()
        }

        function check() {
            var cookie = document.cookie;
            if (cookie.includes("auth")) {
                return true;
            } else {
                return false;
            }
        }
        function updateStatus() {
            if (check()) {
                document.querySelector('div.status').innerHTML = "auth status: auth cookie found";
            } else {
                document.querySelector('div.status').innerHTML = "auth status: auth cookie not found";
            }
            displayCookie()
        }
        
        var  displayCookie = function() {
            var cookieDiv = document.querySelector('div.cookie');

            cookieDiv.innerHTML = document.cookie.replace(/ ;/i, '<br>');;
        }
    </script>


</body>

</html>